generator client {
    provider = "prisma-client-js"
    output   = "../generated/prisma"
}

datasource db {
    provider  = "postgresql"
    url       = env("SUPABASE_URL")
    directUrl = env("SUPABASE_DIRECT_URL")
}

model SeedHistory {
    name       String   @unique
    executedAt DateTime @default(now())

    @@map("_prisma_seed_history")
}

model User {
    id         BigInt   @id @default(autoincrement())
    name       String   @db.VarChar
    email      String   @unique @db.VarChar
    role       UserRole @default(user)
    created_at DateTime @default(now()) @db.Timestamptz(6)
    uid        String?
    Event      Event[]

    @@map("users")
}

model Category {
    id          BigInt            @id @default(autoincrement())
    name        String            @db.VarChar
    description String?           @db.VarChar
    created_at  DateTime          @default(now()) @db.Timestamptz(6)
    events      EventCategories[]

    @@map("categories")
}

model Event {
    id           BigInt            @id @default(autoincrement())
    title        String            @db.VarChar
    description  String?           @db.VarChar
    start_time   DateTime          @db.Timestamp(6)
    end_time     DateTime?         @db.Timestamp(6)
    location     String?           @db.VarChar
    lat          Float?            @db.DoublePrecision
    lng          Float?            @db.DoublePrecision
    organizer_id BigInt
    created_at   DateTime          @default(now()) @db.Timestamptz(6)
    categories   EventCategories[]

    organizer    User              @relation(fields: [organizer_id], references: [id])
    @@map("events")
}

model EventCategories {
    id          BigInt   @id @default(autoincrement())
    event_id    BigInt
    category_id BigInt
    category    Category @relation(fields: [category_id], references: [id])
    event       Event    @relation(fields: [event_id], references: [id])

    @@map("event_categories")
}

enum UserRole {
    user
    organizer
}
